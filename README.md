# smartshop

Правила работы с этим репозиторием

В начале работы открываем консоль, переходим в рабочую директорию, ПАПКУ ДЛЯ ПРОЕКТА НЕ СОЗДАЁМ, она будет создана автоматически! Делаем

git clone АДРЕС ЭТОГО РЕПОЗИТОРИЯ

Перед тем, как что-то поменять в скачанных файлах, сделайте следующее:

git status

// должно написать, что у вас ничего не изменилось, никаких modifyed, deleted!!!

// если результат отличается, смотреть, что изменилось, делать git diff и гуглить, как отменить изменения.

Мы решили ветку мастер не использовать в принципе. Далее я буду писать master, но подразумевать либо server, либо client под test я буду подразумевать соответственно либо test_server, либо test_client.

Далее делаем

git fetch origin

// чтобы скачать все изменения с сервера на локальную машину.

git checkout -b SS-14-list_of_products origin/master

// SS-14 -- таск в жире, далее вместо list_of_products пишем краткое

// содержание того, что Вы хотите сделать

git branch -d master

// не стоит хранить ветки, которые не используете в данный момент.

git status

// убеждаемся, что всё ок, Вы в своей новой ветке.

Правите файлы, добавляете новые, делаете всё, что считаете нужным и полезным для проекта в СВОЕЙ ВЕТКЕ!!!

Затем пишем

git status

// выведется куча изменённых, добавленных и удалённых файлов 

// если Вы добавили новые файлы, нужно написать 

git add путь/к/новому.файлу путь/ко/второму/новому/файлу

git status

// новые файлы зелёные, всё хорошо, изменённые старые -- красные. Красными так же могут быть файлы, которых нет в .gitignore, но которые не нужны в репозитории, они не будут добавлены в репозиторий следующей командой, так что всё ок

git commit -am "SS-14: Я исправил файл a.cpp, удалил b.h, добавил c.h"

// в кавычках -- сначала номер таска, потом ваш комментарий. Номер таска должен быть в каждом коммите, который делается в рамках какого-то таска

Когда Вы Сделали всё, что хотели и довольны своей работой, считаете, что Вы сделали всё возможное в этой ветке, делаете следующее:

git push origin SS-14-list_of_products

git status

// убеждаемся, что всё "up_to_date", красные -- только те файлы, про которые я писал выше, про них ещё будет написано "несопровождаемые файлы"

После этого отправляем задачу на ревью и приступаем к другим таскам.

После ревью и фиксов багов:

Другие не спали, что-то поменяли, нужно это скачать:

git fetch origin

git checkout test

git status

// всё ок

git merge SS-14-list_of_products

// тут он будет совмещать результаты Ваших трудов с тем, что сделали другие

// в результате он выдаст сообщение со списком файлов, которые нужно слить вручную.

// Открываем их, смотрим, что он нам понадобавлял, правим. (поиск по <<<<< )

Если получилось сделать автоматическое слияние, git предложит отредоктировать сообщение, можно оставить как есть.

После того, как просмотрели и исправили все проблемные файлы, проверяем, всё ли работает, исправляем дальше, пока не заработает, делаем коммит:

git commit -a
// редактируем сообщение, вернее, соглашаемся с тем, что предложит git

git push origin test

git status

Передаём задачу на функциональное тестирование

В случае, если тестирование провалилось, нам надо откатить тестовую ветку, ведь в ней хрень:

git pull origin test

git log смотрим hash СВОЕГО мерж-коммита, копируем его и делаем

git revert dgs543rwdgtrhyg345t4tre35465jh5

после этого фиксим, если есть конфликты, проверяем, что всё работает и пушим test обратно:

git push origin test

Затем переходим к своей ветке, фиксим баги, коммитим, пушим, опять ревью, потом мёржим в test...

Следующий пункт делает человек, отвечающий за деплой!!!

Когда тестирование достигло успеха, переходим на ветку, в которой велась разработка и делаем магию:

git log

смотрим, сколько коммитов было сделано в рамках этой задачи (пусть, 5)

git rebase -i HEAD~5

Далее в каждой строчке ставим виесто "pick" "f", кроме самой верхней, в ней пишем "r" сохраняем, закрываем редактор, откроется редактирование текста первого коммита, пишем в него всё, что было сделано в рамках этой задачи, не ограничивая себя, сохраняем, открываем git log и видим, что вместо пяти коммитов у нас один коммит на одну задачу.

ПРОВЕРЯЕМ РАБОТОСПОСОБНОСТЬ!!!

После этого берём бубен, приносим жертву богам разработки и делаем

git push origin SS-14-list_of_products --force

Если вы накосячили, вас будут бить, больно и долго. И не только члены команды, но и просто небезразличные разработчики, весь мир будет вас ненавидеть.

После этого задачу можно вливать в master

git fetch origin

git checkout master

git merge origin/SS-14-list_of_products

фиксим конфликты и пушим

git push origin/master

удаляем ненужные ветки

git branch -D test

git branch -D SS-14-list_of_products

начинаем всё сначала.

# Что делать, если вы начали разработку прямо в мастере:

делаем коммит, а потом

git push origin master:SS-14-list_of_products

это запушит локальный мастер в SS-14-list_of_products после этого переходим на ветку SS-14-list_of_products и удаляем master

git checkout SS-14-list_of_products

git branch -D master
